<div class="reset-password-container">
  <!-- Header -->
  <div class="header-section">
    <img
      src="assets/images/pup_taguig_logo.svg"
      alt="University Logo"
      class="university-logo" />
    <div class="header-text">
      <div class="university-name">
        POLYTECHNIC UNIVERSITY OF THE PHILIPPINES
      </div>
      <div class="system-name">FACULTY LOADING & SCHEDULING</div>
    </div>
  </div>

  <!-- Title -->
  <div class="title-container">
    <div class="title">
      <span mat-symbol="lock_reset" class="title-icon"></span>
      <h1>Reset Password</h1>
    </div>
    <p class="subtitle">Enter your new password below.</p>
  </div>

  <!-- Form -->
  <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" class="reset-form">
    <mat-form-field appearance="fill">
      <mat-label>New Password</mat-label>
      <mat-icon matPrefix class="prefix-icon">lock</mat-icon>
      <input
        matInput
        [type]="showPassword ? 'text' : 'password'"
        formControlName="password"
        placeholder="Enter new password" />
      @if (passwordHasValue) {
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="togglePasswordVisibility()"
        [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'">
        <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      }
      @if (password?.errors?.['required'] && password?.touched) {
      <mat-error>Password is required</mat-error>
      }
      @if (password?.errors?.['minlength']) {
      <mat-error>Password must be at least 8 characters</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Confirm Password</mat-label>
      <mat-icon matPrefix class="prefix-icon">lock</mat-icon>
      <input
        matInput
        [type]="showConfirmPassword ? 'text' : 'password'"
        formControlName="password_confirmation"
        placeholder="Confirm new password" />
      @if (confirmPasswordHasValue) {
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="toggleConfirmPasswordVisibility()"
        [attr.aria-label]="showConfirmPassword ? 'Hide password' : 'Show password'">
        <mat-icon>{{ showConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      }
      @if (passwordConfirmation?.errors?.['required'] && passwordConfirmation?.touched) {
      <mat-error>Please confirm your password</mat-error>
      }
      @if (resetForm.errors?.['passwordMismatch']) {
      <mat-error>Passwords do not match</mat-error>
      }
    </mat-form-field>

    <div class="actions">
      <!-- Cancel Button -->
      <button
        mat-button
        class="cancel-button"
        type="button"
        (click)="onCancel()">
        Back to Login
      </button>

      <!-- Reset Password Button -->
      <button
        mat-flat-button
        class="send-button"
        type="submit"
        [class.disabled]="resetForm.invalid || isLoading"
        [disabled]="resetForm.invalid || isLoading">
        @if (isLoading) {
        <mat-spinner class="custom-spinner" diameter="25"></mat-spinner>
        } @else { Reset Password }
      </button>
    </div>
  </form>
</div>
