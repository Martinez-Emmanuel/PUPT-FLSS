import{a as ae}from"./chunk-Z7LNNC7D.js";import"./chunk-NME5OWLW.js";import{a as g,b as ie}from"./chunk-R7WH3GYF.js";import{a as ne}from"./chunk-PAWPQVJP.js";import"./chunk-2PMUV4MH.js";import{a as N,b as O,c as Y,d as j,e as q,f as U,g as W,h as G,i as J,j as K,k as X,l as Z,m as ee}from"./chunk-OJYR24EB.js";import"./chunk-A3A72ILT.js";import"./chunk-CUKNIT7M.js";import{a as Q}from"./chunk-OGNLWBT2.js";import{a as B}from"./chunk-AY56TXUB.js";import{u as P}from"./chunk-VMH4ILIM.js";import{a as te,b as oe}from"./chunk-6AWQUBPH.js";import{b as L}from"./chunk-JLIX64RS.js";import{c as k,g as A}from"./chunk-VORQTW3B.js";import"./chunk-FVBRAVME.js";import{a as H,c as $}from"./chunk-L2D7AHNW.js";import"./chunk-POHCU53O.js";import{a as z}from"./chunk-6QI4QBU5.js";import"./chunk-DXFFT4B6.js";import{a as F}from"./chunk-UJ255QIO.js";import"./chunk-MXV4M2BO.js";import"./chunk-4N6BO7AP.js";import"./chunk-RU375CWH.js";import"./chunk-KXJUWRJT.js";import"./chunk-SB5MWYDA.js";import"./chunk-EMZRNCIP.js";import"./chunk-DKHW3YWA.js";import{t as I}from"./chunk-2T5SWUVG.js";import{$b as h,Cb as o,Db as a,Eb as x,Fb as _,Gb as u,Ib as w,Nb as R,Pb as p,Tb as E,Ub as M,Vb as T,Wa as m,Xa as S,Zb as l,gc as b,ha as D,hc as V,mb as d,qa as f,qb as v,ra as C,rb as c,xb as y}from"./chunk-NSU275EB.js";import"./chunk-ODN5LVDJ.js";var re=()=>[5,10,25,50,100];function le(t,r){t&1&&(o(0,"div",1),x(1,"app-loading"),a())}function me(t,r){t&1&&(o(0,"th",21),l(1," # "),a())}function de(t,r){if(t&1&&(o(0,"td",22)(1,"span"),l(2),a()()),t&2){let e=r.index,i=p(2);m(2),h(" ",i.getRowIndex(e)," ")}}function pe(t,r){t&1&&(o(0,"th",23),l(1," Room Code "),a())}function se(t,r){if(t&1&&(o(0,"td",24),l(1),a()),t&2){let e=r.$implicit;m(),h(" ",e.roomCode," ")}}function ce(t,r){t&1&&(o(0,"th",23),l(1," Location "),a())}function _e(t,r){if(t&1&&(o(0,"td",24),l(1),a()),t&2){let e=r.$implicit;m(),h(" ",e.location," ")}}function ue(t,r){t&1&&(o(0,"th",23),l(1,"Floor"),a())}function fe(t,r){if(t&1&&(o(0,"td",24),l(1),a()),t&2){let e=r.$implicit;m(),h(" ",e.floorLevel," Floor ")}}function Ce(t,r){t&1&&(o(0,"th",23),l(1," Capacity "),a())}function he(t,r){if(t&1&&(o(0,"td",24),l(1),a()),t&2){let e=r.$implicit;m(),h(" ",e.capacity," ")}}function xe(t,r){t&1&&(o(0,"th",23),l(1," Action "),a())}function Re(t,r){if(t&1){let e=w();o(0,"td",24)(1,"button",25),R("click",function(){let n=f(e).$implicit,s=p(2);return C(s.onView(n))}),o(2,"mat-icon"),l(3,"visibility"),a(),o(4,"span"),l(5,"View Schedule"),a()(),o(6,"button",26),R("click",function(){let n=f(e).$implicit,s=p(2);return C(s.onExportSingle(n))}),o(7,"mat-icon"),l(8,"print"),a(),o(9,"span"),l(10,"Export"),a()()()}}function ge(t,r){t&1&&x(0,"tr",27)}function Se(t,r){t&1&&x(0,"tr",28)}function we(t,r){if(t&1&&(o(0,"tr")(1,"td",29)(2,"div",30)(3,"div",31),x(4,"span",32),o(5,"span"),l(6," No rooms found."),a()()()()()),t&2){let e=p(2);m(),v("colspan",e.displayedColumns.length)}}function De(t,r){if(t&1){let e=w();o(0,"div",2)(1,"app-table-header",3),R("export",function(){f(e);let n=p();return C(n.onExportAll())})("inputChange",function(n){f(e);let s=p();return C(s.onInputChange(n))}),a()(),o(2,"div",4)(3,"div",5)(4,"table",6),_(5,7),d(6,me,2,0,"th",8)(7,de,3,1,"td",9),u(),_(8,10),d(9,pe,2,0,"th",11)(10,se,2,1,"td",12),u(),_(11,13),d(12,ce,2,0,"th",11)(13,_e,2,1,"td",12),u(),_(14,14),d(15,ue,2,0,"th",11)(16,fe,2,1,"td",12),u(),_(17,15),d(18,Ce,2,0,"th",11)(19,he,2,1,"td",12),u(),_(20,16),d(21,xe,2,0,"th",11)(22,Re,11,0,"td",12),u(),d(23,ge,1,0,"tr",17)(24,Se,1,0,"tr",18)(25,we,7,1,"tr",19),a(),o(26,"mat-paginator",20),R("page",function(){f(e);let n=p();return C(n.updateDisplayedData())}),a()()()}if(t&2){let e=p();c("@fadeAnimation",void 0),m(),c("inputFields",e.inputFields)("showExportButton",!0)("showAddButton",!1),m(),c("@fadeAnimation",void 0),m(2),c("dataSource",e.dataSource),m(19),c("matHeaderRowDef",e.displayedColumns),m(),c("matRowDefColumns",e.displayedColumns),m(2),c("length",e.filteredData.length)("pageSize",10)("pageSizeOptions",V(12,re))("showFirstLastButtons",!0)}}var Ye=(()=>{class t{reportsService;dialog;inputFields=[{type:"text",label:"Search Rooms",key:"search"}];displayedColumns=["index","roomCode","location","floor","capacity","action"];dataSource=new ee;filteredData=[];isLoading=!0;paginator;constructor(e,i){this.reportsService=e,this.dialog=i}ngOnInit(){this.fetchRoomData()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngAfterViewChecked(){this.dataSource.paginator!==this.paginator&&(this.dataSource.paginator=this.paginator)}fetchRoomData(){this.isLoading=!0,this.reportsService.getRoomSchedulesReport().subscribe({next:e=>{let i=e.room_schedule_reports.rooms.map(n=>({roomId:n.room_id,roomCode:n.room_code,location:n.location,floorLevel:n.floor_level,capacity:n.capacity,schedules:n.schedules,academicYear:`${e.room_schedule_reports.year_start}-${e.room_schedule_reports.year_end}`,semester:this.getSemesterDisplay(e.room_schedule_reports.semester)}));this.isLoading=!1,this.dataSource.data=i,this.filteredData=[...i],this.dataSource.paginator=this.paginator},error:e=>{this.isLoading=!1,console.error("Error fetching room data:",e)}})}getSemesterDisplay(e){switch(e){case 1:return"1st Semester";case 2:return"2nd Semester";case 3:return"Summer Semester";default:return"Unknown Semester"}}getRowIndex(e){return this.paginator?e+1+this.paginator.pageIndex*this.paginator.pageSize:e+1}onInputChange(e){let i=e.search?e.search.trim().toLowerCase():"";i===""?this.dataSource.data=this.filteredData:this.dataSource.data=this.filteredData.filter(n=>n.roomCode.toLowerCase().includes(i)||n.location.toLowerCase().includes(i)||n.floorLevel.toLowerCase().includes(i))}onView(e){this.dialog.open(ae,{maxWidth:"90vw",width:"100%",data:{exportType:"single",entity:"room",entityData:e.schedules,customTitle:`Room ${e.roomCode}`,academicYear:e.academicYear,semester:e.semester},disableClose:!0})}onExportAll(){console.log("Export All clicked")}onExportSingle(e){console.log("Export clicked for:",e)}updateDisplayedData(){console.log("Paginator updated")}static \u0275fac=function(i){return new(i||t)(S(Q),S(k))};static \u0275cmp=D({type:t,selectors:[["app-report-rooms"]],viewQuery:function(i,n){if(i&1&&E(g,5),i&2){let s;M(s=T())&&(n.paginator=s.first)}},standalone:!0,features:[b],decls:3,vars:1,consts:[[1,"report-container"],[1,"loading-wrapper"],[1,"report-header-container"],[3,"export","inputChange","inputFields","showExportButton","showAddButton"],[1,"report-table-container"],[1,"table-container"],["mat-table","",1,"custom-table",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","class","custom-header index",4,"matHeaderCellDef"],["mat-cell","","class","index",4,"matCellDef"],["matColumnDef","roomCode"],["mat-header-cell","","class","custom-header",4,"matHeaderCellDef"],["mat-cell","","class","custom-cell",4,"matCellDef"],["matColumnDef","location"],["matColumnDef","floor"],["matColumnDef","capacity"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],["aria-label","Select page",1,"custom-paginator",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell","",1,"custom-header","index"],["mat-cell","",1,"index"],["mat-header-cell","",1,"custom-header"],["mat-cell","",1,"custom-cell"],["mat-button","",1,"sec-ripple","view-button",3,"click"],["mat-button","",1,"sec-ripple","export-button",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data-cell"],[1,"flex-cell"],[1,"no-data-text"],["mat-symbol","info"]],template:function(i,n){i&1&&(o(0,"div",0),d(1,le,2,0,"div",1)(2,De,27,13),a()),i&2&&(m(),y(n.isLoading?1:2))},dependencies:[I,ne,B,Z,N,Y,W,j,O,G,q,U,J,K,X,ie,g,oe,te,$,H,L,P,A,F],data:{animation:[z]}})}return t})();export{Ye as ReportRoomsComponent};
