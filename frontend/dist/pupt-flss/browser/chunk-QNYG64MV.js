import{a as Ye}from"./chunk-HKBOYPO3.js";import{a as Re,b as $e}from"./chunk-PRIEC27T.js";import{a as Ue,b as je,c as We}from"./chunk-NME5OWLW.js";import{b as qe,c as tt,d as nt}from"./chunk-BM7DUPOK.js";import{a as se,b as He}from"./chunk-R7WH3GYF.js";import"./chunk-JCJIXIGU.js";import{a as ze}from"./chunk-H5AHOZFT.js";import{a as ce}from"./chunk-6H7VUIJ6.js";import"./chunk-2PMUV4MH.js";import{a as G,b as Q,c as J,d as K,e as X,f as Z,g as ee,h as te,i as ne,j as ie,k as ae,l as oe,m as Le}from"./chunk-OJYR24EB.js";import"./chunk-A3A72ILT.js";import{a as Be,b as Ae}from"./chunk-TVMSW2JO.js";import"./chunk-CUKNIT7M.js";import{a as U}from"./chunk-AY56TXUB.js";import{g as W,k as Y,u as q}from"./chunk-VMH4ILIM.js";import{a as le,b as re}from"./chunk-6AWQUBPH.js";import{a as Ee,b as ke}from"./chunk-JLIX64RS.js";import{a as Ie,b as Ne,c as Ve}from"./chunk-VORQTW3B.js";import"./chunk-FVBRAVME.js";import{a as H,c as z}from"./chunk-L2D7AHNW.js";import"./chunk-POHCU53O.js";import{a as j}from"./chunk-6QI4QBU5.js";import"./chunk-DXFFT4B6.js";import{a as $}from"./chunk-UJ255QIO.js";import"./chunk-MXV4M2BO.js";import"./chunk-4N6BO7AP.js";import"./chunk-RU375CWH.js";import{d as Fe}from"./chunk-KXJUWRJT.js";import"./chunk-SB5MWYDA.js";import"./chunk-EMZRNCIP.js";import"./chunk-DKHW3YWA.js";import{k as De,r as Te,s as Oe,t as R}from"./chunk-2T5SWUVG.js";import{$b as h,Cb as o,Db as r,Eb as y,Fb as f,Gb as _,Ib as T,Nb as x,Pb as m,Ta as xe,Tb as be,Ub as Pe,Vb as Me,Wa as s,Xa as M,Zb as c,_b as fe,ac as _e,cc as V,dc as L,ec as B,g as ye,gc as A,ha as I,hc as F,kc as ve,mb as d,mc as E,nc as we,oc as ue,qa as g,qb as N,ra as C,rb as p,xb as O,zc as Se}from"./chunk-NSU275EB.js";import{g as et}from"./chunk-ODN5LVDJ.js";var Ge=()=>["index","courseCode","courseTitle","lecHours","labHours","units","preferredDay","preferredTime"];function mt(t,l){t&1&&(o(0,"div",1),y(1,"app-loading"),r())}function pt(t,l){t&1&&(o(0,"th",33),c(1," # "),r())}function ft(t,l){if(t&1&&(o(0,"td",34)(1,"span"),c(2),r()()),t&2){let e=l.index;s(2),fe(e+1)}}function _t(t,l){t&1&&(o(0,"th",35),c(1," Course Code "),r())}function ut(t,l){if(t&1&&(o(0,"td",36),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.course_code," ")}}function gt(t,l){t&1&&(o(0,"th",35),c(1," Course Title "),r())}function Ct(t,l){if(t&1&&(o(0,"td",36),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.course_title," ")}}function ht(t,l){t&1&&(o(0,"th",35),c(1,"Lec"),r())}function yt(t,l){if(t&1&&(o(0,"td",36),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.lec_hours," ")}}function xt(t,l){t&1&&(o(0,"th",35),c(1,"Lab"),r())}function bt(t,l){if(t&1&&(o(0,"td",36),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.lab_hours," ")}}function Pt(t,l){t&1&&(o(0,"th",35),c(1," Units "),r())}function Mt(t,l){if(t&1&&(o(0,"td",36),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.units," ")}}function vt(t,l){t&1&&(o(0,"th",35),c(1," Preferred Day "),r())}function wt(t,l){if(t&1&&(o(0,"td",36),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.preferred_day," ")}}function St(t,l){t&1&&(o(0,"th",35),c(1," Preferred Time "),r())}function Dt(t,l){if(t&1&&(o(0,"td",36),c(1),E(2,"date"),E(3,"date"),r()),t&2){let e=l.$implicit,n=m(3);s(),_e(" ",ue(2,2,n.convertToDate(e.preferred_start_time),"h:mm a")," - ",ue(3,5,n.convertToDate(e.preferred_end_time),"h:mm a")," ")}}function Tt(t,l){t&1&&y(0,"tr",37)}function Ot(t,l){t&1&&y(0,"tr",38)}function Ft(t,l){t&1&&(o(0,"tr")(1,"td",39)(2,"div",40),y(3,"span",41),o(4,"span"),c(5,"No preferences has been submitted yet."),r()()()()),t&2&&(s(),N("colspan",8))}function Et(t,l){if(t&1&&(o(0,"div",11)(1,"div",16)(2,"table",17),f(3,18),d(4,pt,2,0,"th",19)(5,ft,3,1,"td",20),_(),f(6,21),d(7,_t,2,0,"th",22)(8,ut,2,1,"td",23),_(),f(9,24),d(10,gt,2,0,"th",22)(11,Ct,2,1,"td",23),_(),f(12,25),d(13,ht,2,0,"th",22)(14,yt,2,1,"td",23),_(),f(15,26),d(16,xt,2,0,"th",22)(17,bt,2,1,"td",23),_(),f(18,27),d(19,Pt,2,0,"th",22)(20,Mt,2,1,"td",23),_(),f(21,28),d(22,vt,2,0,"th",22)(23,wt,2,1,"td",23),_(),f(24,29),d(25,St,2,0,"th",22)(26,Dt,4,8,"td",23),_(),d(27,Tt,1,0,"tr",30)(28,Ot,1,0,"tr",31)(29,Ft,6,1,"tr",32),r()()()),t&2){let e=m(2);s(2),p("dataSource",e.courses)("@fadeAnimation",void 0),s(25),p("matHeaderRowDef",F(4,Ge)),s(),p("matRowDefColumns",F(5,Ge))}}function kt(t,l){if(t&1&&(o(0,"div",42),y(1,"iframe",43),r()),t&2){let e=m(3);s(),p("src",e.pdfBlobUrl,xe)}}function It(t,l){t&1&&(o(0,"div",42)(1,"span"),c(2,"No PDF available."),r()())}function Nt(t,l){if(t&1&&(o(0,"div",12),d(1,kt,2,1,"div",42)(2,It,3,0,"div",42),r()),t&2){let e=m(2);s(),O(e.pdfBlobUrl?1:2)}}function Vt(t,l){if(t&1){let e=T();o(0,"button",44),x("click",function(){g(e);let i=m(2);return C(i.downloadPdf())}),o(1,"mat-icon"),c(2,"print"),r(),c(3," Download PDF "),r()}}function Lt(t,l){if(t&1){let e=T();o(0,"div",2)(1,"div",3)(2,"h2",4),c(3),r(),o(4,"span"),c(5),r()(),o(6,"div",5)(7,"mat-button-toggle-group",6),B("ngModelChange",function(i){g(e);let a=m();return L(a.selectedView,i)||(a.selectedView=i),C(i)}),x("ngModelChange",function(){g(e);let i=m();return C(i.onViewChange())}),o(8,"mat-button-toggle",7)(9,"mat-icon",8),c(10,"table_chart"),r(),o(11,"span"),c(12,"Table view"),r()(),o(13,"mat-button-toggle",9)(14,"mat-icon",8),c(15,"picture_as_pdf"),r(),o(16,"span"),c(17,"PDF view"),r()()()()(),o(18,"div",10),d(19,Et,30,6,"div",11)(20,Nt,3,1,"div",12),r(),o(21,"div",13)(22,"button",14),x("click",function(){g(e);let i=m();return C(i.closeDialog())}),c(23,"Close"),r(),d(24,Vt,4,0,"button",15),r()}if(t&2){let e=m();p("@fadeAnimation",void 0),s(3),fe(e.facultyName),s(2),_e(" Submitted Preferences for A.Y. ",e.academicYear,", ",e.semesterLabel," "),s(2),V("ngModel",e.selectedView),s(12),O(e.selectedView==="table-view"?19:e.selectedView==="pdf-view"?20:-1),s(2),p("@fadeAnimation",void 0),s(3),O(e.selectedView==="pdf-view"?24:-1)}}var Qe=(()=>{class t{preferencesService;dialogRef;data;sanitizer;facultyName="";academicYear="";semesterLabel="";courses=[];isLoading=!0;selectedView="table-view";pdfBlobUrl=null;constructor(e,n,i,a){this.preferencesService=e,this.dialogRef=n,this.data=i,this.sanitizer=a}ngOnInit(){this.isLoading=!0,this.facultyName=this.data.facultyName,this.preferencesService.getPreferences().subscribe(e=>{let n=e.preferences.find(i=>i.faculty_id===this.data.faculty_id);if(n){let i=n.active_semesters[0];this.academicYear=i.academic_year,this.semesterLabel=i.semester_label,this.courses=i.courses.map(a=>({course_code:a.course_details.course_code,course_title:a.course_details.course_title,lec_hours:a.lec_hours,lab_hours:a.lab_hours,units:a.units,preferred_day:a.preferred_day,preferred_start_time:a.preferred_start_time,preferred_end_time:a.preferred_end_time}))}this.isLoading=!1},e=>{console.error("Error loading faculty preferences:",e),this.isLoading=!1})}onViewChange(){this.selectedView==="pdf-view"?this.generateAndDisplayPdf():this.pdfBlobUrl=null}generateAndDisplayPdf(){if(this.data.generatePdfFunction){let e=this.data.generatePdfFunction(!0);if(e instanceof Blob){let n=URL.createObjectURL(e);this.pdfBlobUrl=this.sanitizer.bypassSecurityTrustResourceUrl(n)}else console.error("generatePdfFunction did not return a Blob.")}else console.error("No generatePdfFunction provided.")}downloadPdf(){this.data.generatePdfFunction?this.data.generatePdfFunction(!1):console.error("No generatePdfFunction provided.")}closeDialog(){this.dialogRef.close()}convertToDate(e){return new Date(`1970-01-01T${e}`)}static \u0275fac=function(n){return new(n||t)(M(ce),M(Ie),M(Ne),M(Fe))};static \u0275cmp=I({type:t,selectors:[["app-dialog-pref"]],standalone:!0,features:[A],decls:3,vars:1,consts:[[1,"dialog-pref-container"],[1,"loading-wrapper"],[1,"faculty-info"],[1,"info-text"],[1,"faculty-name"],[1,"view-option"],["name","viewOption",3,"ngModelChange","ngModel"],["value","table-view"],[1,"icon-spacing"],["value","pdf-view"],[1,"dialog-pref-content"],[1,"dialog-pref-table-container"],[1,"dialog-pref-pdf-container"],[1,"dialog-actions"],["mat-button","",3,"click"],["mat-flat-button",""],[1,"table-container"],["mat-table","",1,"custom-table",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","class","custom-header index",4,"matHeaderCellDef"],["mat-cell","","class","index",4,"matCellDef"],["matColumnDef","courseCode"],["mat-header-cell","","class","custom-header",4,"matHeaderCellDef"],["mat-cell","","class","custom-cell",4,"matCellDef"],["matColumnDef","courseTitle"],["matColumnDef","lecHours"],["matColumnDef","labHours"],["matColumnDef","units"],["matColumnDef","preferredDay"],["matColumnDef","preferredTime"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],["mat-header-cell","",1,"custom-header","index"],["mat-cell","",1,"index"],["mat-header-cell","",1,"custom-header"],["mat-cell","",1,"custom-cell"],["mat-header-row",""],["mat-row",""],[1,"no-data-cell"],[1,"flex-cell"],["mat-symbol","info"],[1,"pdf-container"],[1,"pdf-iframe",3,"src"],["mat-flat-button","",3,"click"]],template:function(n,i){n&1&&(o(0,"div",0),d(1,mt,2,0,"div",1)(2,Lt,25,8),r()),n&2&&(s(),O(i.isLoading?1:2))},dependencies:[R,Oe,q,W,Y,U,oe,G,J,ee,K,Q,te,X,Z,ne,ie,ae,z,H,We,Ue,je,re,le,$],styles:[".dialog-pref-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start;gap:var(--spacing-md);padding:var(--spacing-lg);height:100%}.faculty-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:stretch;justify-content:space-between;gap:0;color:var(--primary-text)}.faculty-info[_ngcontent-%COMP%]   .faculty-name[_ngcontent-%COMP%]{font-weight:600;margin:0;padding:0;border:0;box-sizing:border-box}.dialog-pref-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:none;justify-content:none;gap:0;-ms-overflow-style:none;scrollbar-width:none;overflow:scroll;position:relative;border-radius:var(--border-radius-md);max-height:var(--dialog-base-height);box-shadow:var(--shadow-level-1)}.dialog-pref-table-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none;display:flex;flex-direction:column;background-color:var(--neutral-light)}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]{transition:background-color .3s ease;background-color:var(--neutral-light)}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .table-button[_ngcontent-%COMP%]{color:var(--primary-text)}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{padding:0 var(--spacing-md);text-align:center}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .custom-header[_ngcontent-%COMP%]{text-wrap:nowrap;background-color:var(--primary-one);color:#fff;font-weight:500;text-align:center;position:sticky;top:0;z-index:2}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]{padding:var(--spacing-xs);text-align:center}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .no-data-cell[_ngcontent-%COMP%]{text-align:center;padding:var(--spacing-lg)}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .no-data-cell[_ngcontent-%COMP%]   .flex-cell[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;gap:var(--spacing-xs)}.dialog-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .no-data-cell[_ngcontent-%COMP%]   .flex-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:var(--opacity-semi-opaque)}.dialog-pref-pdf-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start;gap:0;max-height:var(--dialog-base-height)}.dialog-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:flex-end;gap:var(--spacing-sm);padding-top:var(--spacing-xs)}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:var(--primary-text)}"],data:{animation:[j]}})}return t})();tt();var $n=et(nt());var Bt=()=>[5,10,25,50,100],At=(t,l,e)=>({"full-time":t,"full-time-designee":l,"part-time":e});function Rt(t,l){t&1&&(o(0,"div",1),y(1,"app-loading"),r())}function $t(t,l){t&1&&(o(0,"th",22),c(1," # "),r())}function Ht(t,l){if(t&1&&(o(0,"td",23)(1,"span"),c(2),r()()),t&2){let e=l.index,n=m(2);s(2),h(" ",e+1+((n.paginator==null?null:n.paginator.pageIndex)||0)*((n.paginator==null?null:n.paginator.pageSize)||10)," ")}}function zt(t,l){t&1&&(o(0,"th",24),c(1," Faculty Name "),r())}function Ut(t,l){if(t&1&&(o(0,"td",25),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.facultyName," ")}}function jt(t,l){t&1&&(o(0,"th",24),c(1," Faculty Code "),r())}function Wt(t,l){if(t&1&&(o(0,"td",25),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.facultyCode," ")}}function Yt(t,l){t&1&&(o(0,"th",24),c(1," Faculty Type "),r())}function qt(t,l){if(t&1&&(o(0,"td",25)(1,"span",26),c(2),r()()),t&2){let e=l.$implicit;s(),p("ngClass",ve(2,At,e.facultyType.toLowerCase().includes("full-time")||e.facultyType.toLowerCase().includes("temporary"),e.facultyType.toLowerCase().includes("designee"),e.facultyType.toLowerCase().includes("part-time"))),s(),h(" ",e.facultyType," ")}}function Gt(t,l){t&1&&(o(0,"th",24),c(1,"Units"),r())}function Qt(t,l){if(t&1&&(o(0,"td",25),c(1),r()),t&2){let e=l.$implicit;s(),h(" ",e.facultyUnits," ")}}function Jt(t,l){t&1&&(o(0,"th",24),c(1," Action "),r())}function Kt(t,l){if(t&1){let e=T();o(0,"td",25)(1,"button",27),x("click",function(){let i=g(e).$implicit,a=m(2);return C(a.onView(i))}),o(2,"mat-icon"),c(3,"visibility"),r(),o(4,"span"),c(5,"View Preferences"),r()(),o(6,"button",28),x("click",function(){let i=g(e).$implicit,a=m(2);return C(a.onExportSingle(i))}),o(7,"mat-icon"),c(8,"print"),r(),o(9,"span"),c(10,"Export"),r()()()}}function Xt(t,l){if(t&1){let e=T();o(0,"th",24)(1,"mat-slide-toggle",29),x("change",function(i){g(e);let a=m(2);return C(a.onToggleAllChange(i))}),r()()}if(t&2){let e=m(2);s(),p("checked",e.isToggleAllChecked)}}function Zt(t,l){if(t&1){let e=T();o(0,"td",25)(1,"mat-slide-toggle",30),B("ngModelChange",function(i){let a=g(e).$implicit;return L(a.is_enabled,i)||(a.is_enabled=i),C(i)}),x("change",function(){let i=g(e).$implicit,a=m(2);return C(a.onToggleSingleChange(i))}),r()()}if(t&2){let e=l.$implicit;s(),V("ngModel",e.is_enabled)}}function en(t,l){t&1&&y(0,"tr",31)}function tn(t,l){t&1&&y(0,"tr",32)}function nn(t,l){if(t&1&&(o(0,"tr")(1,"td",33)(2,"div",34)(3,"div",35),y(4,"span",36),o(5,"span"),c(6," No faculty found."),r()()()()()),t&2){let e=m(2);s(),N("colspan",e.displayedColumns.length)}}function an(t,l){if(t&1){let e=T();o(0,"div",2)(1,"app-table-header",3),x("export",function(){g(e);let i=m();return C(i.onExportAll())})("inputChange",function(i){g(e);let a=m();return C(a.onInputChange(i))}),r()(),o(2,"div",4)(3,"div",5)(4,"table",6),f(5,7),d(6,$t,2,0,"th",8)(7,Ht,3,1,"td",9),_(),f(8,10),d(9,zt,2,0,"th",11)(10,Ut,2,1,"td",12),_(),f(11,13),d(12,jt,2,0,"th",11)(13,Wt,2,1,"td",12),_(),f(14,14),d(15,Yt,2,0,"th",11)(16,qt,3,6,"td",12),_(),f(17,15),d(18,Gt,2,0,"th",11)(19,Qt,2,1,"td",12),_(),f(20,16),d(21,Jt,2,0,"th",11)(22,Kt,11,0,"td",12),_(),f(23,17),d(24,Xt,2,1,"th",11)(25,Zt,2,1,"td",12),_(),d(26,en,1,0,"tr",18)(27,tn,1,0,"tr",19)(28,nn,7,1,"tr",20),r(),o(29,"mat-paginator",21),x("page",function(){g(e);let i=m();return C(i.updateDisplayedData())}),r()()()}if(t&2){let e=m();p("@fadeAnimation",void 0),s(),p("inputFields",e.inputFields)("showExportButton",!0)("showAddButton",!1),s(),p("@fadeAnimation",void 0),s(2),p("dataSource",e.dataSource),s(22),p("matHeaderRowDef",e.displayedColumns),s(),p("matRowDefColumns",e.displayedColumns),s(2),p("length",e.filteredData.length)("pageSize",10)("pageSizeOptions",F(12,Bt))("showFirstLastButtons",!0)}}var Hn=(()=>{class t{preferencesService;snackBar;dialog;cdr;inputFields=[{type:"text",label:"Search Faculty",key:"searchFaculty"}];displayedColumns=["index","facultyName","facultyCode","facultyType","facultyUnits","action","toggle"];dataSource=new Le([]);allData=[];filteredData=[];isToggleAllChecked=!1;isLoading=new ye(!0);currentFilter="";paginator;constructor(e,n,i,a){this.preferencesService=e,this.snackBar=n,this.dialog=i,this.cdr=a}ngOnInit(){this.loadFacultyPreferences(),this.dataSource.filterPredicate=(e,n)=>e.facultyName.toLowerCase().includes(n)||e.facultyCode.toLowerCase().includes(n)||e.facultyType.toLowerCase().includes(n)}ngAfterViewInit(){this.dataSource.paginator=this.paginator??null,this.applyFilter(this.currentFilter)}loadFacultyPreferences(){this.isLoading.next(!0),this.preferencesService.getPreferences().subscribe(e=>{let n=e.preferences.map(i=>({faculty_id:i.faculty_id,facultyName:i.faculty_name,facultyCode:i.faculty_code,facultyType:i.faculty_type,facultyUnits:i.faculty_units,is_enabled:i.is_enabled===1,active_semesters:i.active_semesters}));console.log("Processed Faculty Data:",n),this.allData=n,this.filteredData=n,this.applyFilter(this.currentFilter),this.checkToggleAllState(),this.isLoading.next(!1)},e=>{console.error("Error loading faculty preferences:",e),this.snackBar.open("Error loading faculty preferences. Please try again.","Close",{duration:3e3}),this.isLoading.next(!1)})}applyFilter(e){this.currentFilter=e.trim().toLowerCase(),this.currentFilter===""?this.filteredData=[...this.allData]:this.filteredData=this.allData.filter(n=>this.filterPredicate(n,this.currentFilter)),this.paginator&&this.paginator.firstPage(),this.updateDisplayedData()}filterPredicate(e,n){return e.facultyName.toLowerCase().includes(n)||e.facultyCode.toLowerCase().includes(n)||e.facultyType.toLowerCase().includes(n)}updateDisplayedData(){if(this.paginator){let e=this.paginator.pageIndex*this.paginator.pageSize,n=e+this.paginator.pageSize;this.dataSource.data=this.filteredData.slice(e,n)}else this.dataSource.data=[...this.filteredData]}checkToggleAllState(){let e=this.filteredData.every(n=>n.is_enabled);this.isToggleAllChecked=e}onToggleSingleChange(e){let n=e.is_enabled;this.preferencesService.toggleFacultyPreferences(e.faculty_id,n).subscribe(i=>{this.snackBar.open(`Preferences submission ${n?"enabled":"disabled"} for ${e.facultyName}.`,"Close",{duration:3e3}),this.checkToggleAllState(),this.cdr.markForCheck()},i=>{this.snackBar.open(`Failed to update preference for ${e.facultyName}`,"Close",{duration:3e3}),console.error("Error updating faculty preference:",i)})}onToggleAllChange(e){let n=e.checked,i=this.snackBar.open("Loading, please wait...","Close",{duration:void 0});this.preferencesService.toggleAllFacultyPreferences(n).subscribe(a=>{this.filteredData.forEach(u=>u.is_enabled=n),this.updateDisplayedData(),i.dismiss(),this.snackBar.open(`Preferences submission for all faculty is ${n?"enabled":"disabled"}.`,"Close",{duration:3e3}),this.isToggleAllChecked=n,this.cdr.markForCheck()},a=>{i.dismiss(),this.snackBar.open("Failed to update preferences for all faculty","Close",{duration:3e3}),console.error("Error updating all preferences:",a)})}onInputChange(e){let n=e.searchFaculty||"";this.applyFilter(n)}onView(e){let n=a=>this.generateFacultyPDF(!1,[e],a);this.dialog.open(Qe,{maxWidth:"70rem",width:"100%",data:{facultyName:e.facultyName,faculty_id:e.faculty_id,generatePdfFunction:n},disableClose:!0}).afterClosed().subscribe(a=>{console.log("Dialog closed",a)})}onExportAll(){if(!this.allData.length){this.snackBar.open("No faculty preferences available for export.","Close",{duration:3e3});return}let e=this.allData.find(u=>u.active_semesters&&u.active_semesters.length>0);if(!e){this.snackBar.open("No active semester data available for export.","Close",{duration:3e3});return}let{academic_year:n,semester_label:i}=e.active_semesters[0];this.dialog.open(Ye,{maxWidth:"70rem",width:"100%",data:{exportType:"all",entity:"faculty",entityData:{name:"Export All Faculty Preferences",academic_year:n,semester_label:i},generatePdfFunction:()=>this.generateFacultyPDF(!0,this.allData,!0),generateFileNameFunction:()=>`${n.replace("/","_")}_${i.toLowerCase()}_faculty_preferences_report.pdf`},disableClose:!0}).afterClosed().subscribe(u=>{console.log("Export All dialog closed",u)})}onExportSingle(e){let n=e.active_semesters?.[0];if(!n||!n.courses?.length){let i=n?`No preferences available for ${e.facultyName}.`:`No active semesters available for ${e.facultyName}.`;this.snackBar.open(i,"Close",{duration:3e3});return}this.generateFacultyPDF(!1,[e],!1),this.snackBar.open(`Downloading PDF for ${e.facultyName}...`,"Close",{duration:3e3})}generateFacultyPDF(e,n,i=!1){let a=new qe("p","mm","legal"),u=a.internal.pageSize.width,w=10,b=15,ge=22,S=b,de={font:"times",style:"bold",size:12},me={font:"times",style:"normal",size:12},k={align:"center"},Ce=()=>{a.addImage("https://iantuquib.weebly.com/uploads/5/9/7/7/59776029/2881282_orig.png","PNG",w,10,ge,ge),a.setFontSize(de.size),a.setFont(de.font,de.style),a.text("POLYTECHNIC UNIVERSITY OF THE PHILIPPINES \u2013 TAGUIG BRANCH",u/2,b,k),a.text("Gen. Santos Ave. Upper Bicutan, Taguig City",u/2,b+5,k),a.setFontSize(15),e?a.text("All Faculty Preferences Report",u/2,b+15,k):a.text("Faculty Preferences Report",u/2,b+15,k),a.setDrawColor(0,0,0),a.setLineWidth(.5),a.line(w,b+20,u-w,b+20),S=b+25};Ce(),n.forEach((D,Ke)=>{let v=D.active_semesters?.[0];if(!v||!v.courses?.length)return;a.setFontSize(me.size),a.setFont(me.font,me.style),[`Faculty Name: ${D.facultyName}`,`Faculty Code: ${D.facultyCode}`,`Academic Year: ${v.academic_year}`,`Semester: ${v.semester_label}`].forEach(P=>{a.text(P,w,S),S+=5}),S+=5;let pe=v.courses.map((P,Ze)=>[(Ze+1).toString(),P.course_details?.course_code||"N/A",P.course_details?.course_title||"N/A",P.lec_hours.toString(),P.lab_hours.toString(),P.units.toString(),P.preferred_day,`${this.formatTimeTo12Hour(P.preferred_start_time)} - ${this.formatTimeTo12Hour(P.preferred_end_time)}`]),Xe={startY:S,head:[["#","Course Code","Course Title","Lec","Lab","Units","Preferred Day","Preferred Time"]],body:pe,theme:"grid",headStyles:{fillColor:[128,0,0],textColor:[255,255,255],fontSize:9},bodyStyles:{fontSize:8,textColor:[0,0,0]},styles:{lineWidth:.1,overflow:"linebreak",cellPadding:2},columnStyles:{0:{cellWidth:10},1:{cellWidth:30},2:{cellWidth:50},3:{cellWidth:13},4:{cellWidth:13},5:{cellWidth:13},6:{cellWidth:25},7:{cellWidth:35}},margin:{left:w,right:w}};a.autoTable(Xe),S=a.autoTable.previous.finalY+10,S>270&&(a.addPage(),Ce(),S=b+25)});let Je=a.output("blob");if(i)return Je;{let D="faculty_preferences_report.pdf";if(e){let v=n[0].active_semesters?.[0];if(v){let he=v.academic_year.replace("/","_"),pe=v.semester_label.toLowerCase();D=`${he}_${pe}_faculty_preferences.pdf`}}else D=`${this.sanitizeFileName(n[0].facultyName)}_preferences_report.pdf`;a.save(D)}}sanitizeFileName(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"_")}formatTimeTo12Hour(e){let[n,i]=e.split(":"),a=parseInt(n,10),u=i.length===2?i:`0${i}`,w=a>=12?"PM":"AM";return`${a%12||12}:${u} ${w}`}static \u0275fac=function(n){return new(n||t)(M(ce),M(Be),M(Ve),M(Se))};static \u0275cmp=I({type:t,selectors:[["app-faculty-pref"]],viewQuery:function(n,i){if(n&1&&be(se,5),n&2){let a;Pe(a=Me())&&(i.paginator=a.first)}},standalone:!0,features:[A],decls:4,vars:3,consts:[[1,"faculty-pref-container"],[1,"loading-wrapper"],[1,"faculty-pref-header-container"],[3,"export","inputChange","inputFields","showExportButton","showAddButton"],[1,"faculty-pref-table-container"],[1,"table-container"],["mat-table","",1,"custom-table",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","class","custom-header index",4,"matHeaderCellDef"],["mat-cell","","class","index",4,"matCellDef"],["matColumnDef","facultyName"],["mat-header-cell","","class","custom-header",4,"matHeaderCellDef"],["mat-cell","","class","custom-cell",4,"matCellDef"],["matColumnDef","facultyCode"],["matColumnDef","facultyType"],["matColumnDef","facultyUnits"],["matColumnDef","action"],["matColumnDef","toggle"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],["aria-label","Select page",1,"custom-paginator",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell","",1,"custom-header","index"],["mat-cell","",1,"index"],["mat-header-cell","",1,"custom-header"],["mat-cell","",1,"custom-cell"],[1,"faculty-type",3,"ngClass"],["mat-button","",1,"sec-ripple","view-button",3,"click"],["mat-button","",1,"sec-ripple","export-button",3,"click"],["matTooltip","Toggle preferences submission for all faculty",1,"header-toggle",3,"change","checked"],["matTooltip","Toggle preferences submission for this faculty only",3,"ngModelChange","change","ngModel"],["mat-header-row",""],["mat-row",""],[1,"no-data-cell"],[1,"flex-cell"],[1,"no-data-text"],["mat-symbol","info"]],template:function(n,i){n&1&&(o(0,"div",0),d(1,Rt,2,0,"div",1),E(2,"async"),d(3,an,30,13),r()),n&2&&(s(),O(we(2,1,i.isLoading)?1:3))},dependencies:[R,De,Te,ze,U,q,W,Y,oe,G,J,ee,K,Q,te,X,Z,ne,ie,ae,z,H,re,le,$e,Re,He,se,ke,Ee,Ae,$],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;border:0;box-sizing:border-box}.faculty-pref-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start;gap:var(--spacing-sm);height:100%}.faculty-pref-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:none;justify-content:none;gap:0;-ms-overflow-style:none;scrollbar-width:none;overflow:auto;position:relative;border-radius:var(--border-radius-md);box-shadow:var(--shadow-level-1)}.faculty-pref-table-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none;display:flex;flex-direction:column;background-color:var(--neutral-light);max-height:50rem}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]{transition:background-color .3s ease;background-color:var(--neutral-light)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-table[_ngcontent-%COMP%]   .table-button[_ngcontent-%COMP%]{color:var(--primary-text)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{padding:0 var(--spacing-md);text-align:center}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-header[_ngcontent-%COMP%]{text-wrap:nowrap;background-color:var(--primary-one);color:#fff;font-weight:500;text-align:center;position:sticky;top:0;z-index:2}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]{padding:var(--spacing-xs);text-align:center}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .faculty-type[_ngcontent-%COMP%]{width:fit-content;padding:var(--spacing-xxs) var(--spacing-xs);border-radius:var(--border-radius-xs);font-size:var(--font-size-xsx);font-weight:500}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .faculty-type.full-time[_ngcontent-%COMP%]{background-color:var(--blue-fade-lighter);color:var(--blue-primary)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .faculty-type.full-time-designee[_ngcontent-%COMP%]{background-color:var(--aqua-fade-lighter);color:var(--aqua-primary)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .faculty-type.part-time[_ngcontent-%COMP%]{background-color:var(--purple-fade-lighter);color:var(--purple-primary)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .view-button[_ngcontent-%COMP%]{color:var(--secondary-text);margin-right:var(--spacing-md)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .view-button[_ngcontent-%COMP%]:hover{background-color:var(--secondary-hover)!important}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .export-button[_ngcontent-%COMP%]{color:var(--secondary-text)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .custom-cell[_ngcontent-%COMP%]   .export-button[_ngcontent-%COMP%]:hover{background-color:var(--secondary-hover)!important}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .no-data-cell[_ngcontent-%COMP%]{text-align:center;padding:var(--spacing-lg)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .no-data-cell[_ngcontent-%COMP%]   .flex-cell[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;gap:var(--spacing-xs)}.faculty-pref-table-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .no-data-cell[_ngcontent-%COMP%]   .flex-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:var(--opacity-semi-opaque)}"],data:{animation:[j]}})}return t})();export{Hn as FacultyPrefComponent};
