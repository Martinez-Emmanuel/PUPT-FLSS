import{a as fe}from"./chunk-Z7LNNC7D.js";import{a as me,b as ue}from"./chunk-PRIEC27T.js";import"./chunk-NME5OWLW.js";import{a as w,b as _e}from"./chunk-R7WH3GYF.js";import{a as he}from"./chunk-PAWPQVJP.js";import"./chunk-2PMUV4MH.js";import{a as J,b as K,c as X,d as Z,e as ee,f as te,g as ie,h as ae,i as ne,j as oe,k as le,l as re,m as se}from"./chunk-OJYR24EB.js";import"./chunk-A3A72ILT.js";import{a as pe}from"./chunk-TVMSW2JO.js";import"./chunk-CUKNIT7M.js";import{a as O}from"./chunk-OGNLWBT2.js";import{a as W}from"./chunk-AY56TXUB.js";import{g as Y,k as q,u as G}from"./chunk-VMH4ILIM.js";import{a as ce,b as de}from"./chunk-6AWQUBPH.js";import{a as N,b as $}from"./chunk-JLIX64RS.js";import{c as H,g as U}from"./chunk-VORQTW3B.js";import"./chunk-FVBRAVME.js";import{a as z,c as Q}from"./chunk-L2D7AHNW.js";import"./chunk-POHCU53O.js";import{a as j}from"./chunk-6QI4QBU5.js";import"./chunk-DXFFT4B6.js";import{a as P}from"./chunk-UJ255QIO.js";import"./chunk-MXV4M2BO.js";import"./chunk-4N6BO7AP.js";import"./chunk-RU375CWH.js";import"./chunk-KXJUWRJT.js";import"./chunk-SB5MWYDA.js";import"./chunk-EMZRNCIP.js";import"./chunk-DKHW3YWA.js";import{k as L,t as B}from"./chunk-2T5SWUVG.js";import{$b as y,Cb as n,Db as r,Eb as C,Fb as h,Gb as f,Ib as x,Nb as g,Pb as d,Tb as F,Ub as R,Vb as D,Wa as c,Xa as S,Zb as s,cc as M,dc as v,ec as k,gc as V,ha as b,hc as A,kc as I,mb as m,qa as u,qb as T,ra as _,rb as p,xb as E}from"./chunk-NSU275EB.js";import"./chunk-ODN5LVDJ.js";var ge=()=>[5,10,25,50,100],Ce=(t,o,e)=>({"full-time":t,"full-time-designee":o,"part-time":e});function ye(t,o){t&1&&(n(0,"div",1),C(1,"app-loading"),r())}function xe(t,o){t&1&&(n(0,"th",22),s(1," # "),r())}function Se(t,o){if(t&1&&(n(0,"td",23)(1,"span"),s(2),r()()),t&2){let e=o.index,a=d(2);c(2),y(" ",a.getRowIndex(e)," ")}}function we(t,o){t&1&&(n(0,"th",24),s(1," Faculty Name "),r())}function be(t,o){if(t&1&&(n(0,"td",25),s(1),r()),t&2){let e=o.$implicit;c(),y(" ",e.facultyName," ")}}function Te(t,o){t&1&&(n(0,"th",24),s(1," Faculty Code "),r())}function Ee(t,o){if(t&1&&(n(0,"td",25),s(1),r()),t&2){let e=o.$implicit;c(),y(" ",e.facultyCode," ")}}function Fe(t,o){t&1&&(n(0,"th",24),s(1," Faculty Type "),r())}function Re(t,o){if(t&1&&(n(0,"td",25)(1,"span",26),s(2),r()()),t&2){let e=o.$implicit;c(),p("ngClass",I(2,Ce,e.facultyType.toLowerCase().includes("full-time")||e.facultyType.toLowerCase().includes("temporary"),e.facultyType.toLowerCase().includes("designee"),e.facultyType.toLowerCase().includes("part-time"))),c(),y(" ",e.facultyType," ")}}function De(t,o){t&1&&(n(0,"th",24),s(1," Load"),C(2,"br"),s(3," (Units) "),r())}function Me(t,o){if(t&1&&(n(0,"td",25),s(1),r()),t&2){let e=o.$implicit;c(),y(" ",e.facultyUnits," ")}}function ve(t,o){t&1&&(n(0,"th",24),s(1," Action "),r())}function ke(t,o){if(t&1){let e=x();n(0,"td",25)(1,"button",27),g("click",function(){let i=u(e).$implicit,l=d(2);return _(l.onView(i))}),n(2,"mat-icon"),s(3,"visibility"),r(),n(4,"span"),s(5,"View Schedule"),r()(),n(6,"button",28),g("click",function(){let i=u(e).$implicit,l=d(2);return _(l.onExportSingle(i))}),n(7,"mat-icon"),s(8,"print"),r(),n(9,"span"),s(10,"Export"),r()()()}}function Ve(t,o){if(t&1){let e=x();n(0,"th",24)(1,"mat-slide-toggle",29),g("change",function(i){u(e);let l=d(2);return _(l.onToggleAllChange(i))}),r()()}if(t&2){let e=d(2);c(),p("matTooltip",e.hasSchedulesForToggleAll?"Publish/unpublish schedule for all applicable faculty":"Cannot publish/unpublish empty schedules")("checked",e.isToggleAllChecked)("disabled",!e.hasSchedulesForToggleAll)}}function Ae(t,o){if(t&1){let e=x();n(0,"td",25)(1,"mat-slide-toggle",30),k("ngModelChange",function(i){let l=u(e).$implicit;return v(l.isEnabled,i)||(l.isEnabled=i),_(i)}),g("change",function(){let i=u(e).$implicit,l=d(2);return _(l.onToggleChange(i))}),r()()}if(t&2){let e=o.$implicit;c(),M("ngModel",e.isEnabled),p("disabled",!e.schedules||e.schedules.length===0)("matTooltip",e.schedules&&e.schedules.length>0?"Publish/unpublish schedule for this faculty only":"Cannot publish/unpublish empty schedules")}}function Ie(t,o){t&1&&C(0,"tr",31)}function Le(t,o){t&1&&C(0,"tr",32)}function Be(t,o){if(t&1&&(n(0,"tr")(1,"td",33)(2,"div",34)(3,"div",35),C(4,"span",36),n(5,"span"),s(6," No faculty found."),r()()()()()),t&2){let e=d(2);c(),T("colspan",e.displayedColumns.length)}}function Ne(t,o){if(t&1){let e=x();n(0,"div",2)(1,"app-table-header",3),g("export",function(){u(e);let i=d();return _(i.onExportAll())})("inputChange",function(i){u(e);let l=d();return _(l.onInputChange(i))}),r()(),n(2,"div",4)(3,"div",5)(4,"table",6),h(5,7),m(6,xe,2,0,"th",8)(7,Se,3,1,"td",9),f(),h(8,10),m(9,we,2,0,"th",11)(10,be,2,1,"td",12),f(),h(11,13),m(12,Te,2,0,"th",11)(13,Ee,2,1,"td",12),f(),h(14,14),m(15,Fe,2,0,"th",11)(16,Re,3,6,"td",12),f(),h(17,15),m(18,De,4,0,"th",11)(19,Me,2,1,"td",12),f(),h(20,16),m(21,ve,2,0,"th",11)(22,ke,11,0,"td",12),f(),h(23,17),m(24,Ve,2,3,"th",11)(25,Ae,2,3,"td",12),f(),m(26,Ie,1,0,"tr",18)(27,Le,1,0,"tr",19)(28,Be,7,1,"tr",20),r(),n(29,"mat-paginator",21),g("page",function(){u(e);let i=d();return _(i.updateDisplayedData())}),r()()()}if(t&2){let e=d();p("@fadeAnimation",void 0),c(),p("inputFields",e.inputFields)("showExportButton",!0)("showAddButton",!1),c(),p("@fadeAnimation",void 0),c(2),p("dataSource",e.dataSource),c(22),p("matHeaderRowDef",e.displayedColumns),c(),p("matRowDefColumns",e.displayedColumns),c(2),p("length",e.filteredData.length)("pageSize",10)("pageSizeOptions",A(12,ge))("showFirstLastButtons",!0)}}var dt=(()=>{class t{reportsService;dialog;snackBar;inputFields=[{type:"text",label:"Search Faculty",key:"search"}];displayedColumns=["index","facultyName","facultyCode","facultyType","facultyUnits","action","toggle"];dataSource=new se;filteredData=[];hasSchedulesForToggleAll=!1;isToggleAllChecked=!1;isLoading=!0;paginator;constructor(e,a,i){this.reportsService=e,this.dialog=a,this.snackBar=i}ngOnInit(){this.fetchFacultyData()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngAfterViewChecked(){this.dataSource.paginator!==this.paginator&&(this.dataSource.paginator=this.paginator)}fetchFacultyData(){this.isLoading=!0,this.reportsService.getFacultySchedulesReport().subscribe({next:e=>{let a=e.faculty_schedule_reports.faculties.map(i=>({facultyName:i.faculty_name,facultyCode:i.faculty_code,facultyType:i.faculty_type,facultyUnits:i.assigned_units,isEnabled:i.is_published===1,facultyId:i.faculty_id,schedules:i.schedules||[],academicYear:`${e.faculty_schedule_reports.year_start}-${e.faculty_schedule_reports.year_end}`,semester:this.getSemesterDisplay(e.faculty_schedule_reports.semester)}));this.isLoading=!1,this.dataSource.data=a,this.filteredData=[...a],this.dataSource.paginator=this.paginator,this.hasSchedulesForToggleAll=a.some(i=>i.schedules&&i.schedules.length>0),this.isToggleAllChecked=this.dataSource.data.length>0&&this.dataSource.data.every(i=>i.isEnabled)},error:e=>{this.isLoading=!1,console.error("Error fetching faculty data:",e)}})}getSemesterDisplay(e){switch(e){case 1:return"1st Semester";case 2:return"2nd Semester";case 3:return"Summer Semester";default:return"Unknown Semester"}}getRowIndex(e){return this.paginator?e+1+this.paginator.pageIndex*this.paginator.pageSize:e+1}onInputChange(e){let a=e.search?e.search.trim().toLowerCase():"";a===""?this.dataSource.data=this.filteredData:this.dataSource.data=this.filteredData.filter(i=>i.facultyName.toLowerCase().includes(a)||i.facultyCode.toLowerCase().includes(a)||i.facultyType.toLowerCase().includes(a)),this.isToggleAllChecked=this.dataSource.data.length>0&&this.dataSource.data.every(i=>i.isEnabled)}onView(e){this.dialog.open(fe,{maxWidth:"90vw",width:"100%",data:{exportType:"single",entity:"faculty",entityData:e.schedules,customTitle:`${e.facultyName}`,academicYear:e.academicYear,semester:e.semester},disableClose:!0})}onExportAll(){console.log("Export All clicked")}onExportSingle(e){console.log("Export clicked for:",e)}onToggleAllChange(e){let a=e.checked?1:0;this.snackBar.open("Loading, please wait...","Close",{duration:void 0}),this.reportsService.togglePublishAllSchedules(a).subscribe({next:i=>{this.dataSource.data.forEach(l=>{l.schedules&&l.schedules.length>0&&(l.isEnabled=a===1)}),this.isToggleAllChecked=this.dataSource.data.length>0&&this.dataSource.data.filter(l=>l.schedules&&l.schedules.length>0).every(l=>l.isEnabled),this.snackBar.open("Schedules successfully published for all applicable faculty.","Close",{duration:3e3})},error:i=>{console.error("Error toggling all schedules:",i),this.isToggleAllChecked=!e.checked,this.snackBar.open("Error publishing schedules for all applicable faculty.","Close",{duration:3e3})}})}onToggleChange(e){let a=e.isEnabled?1:0;this.snackBar.open("Loading, please wait...","Close",{duration:void 0}),this.reportsService.togglePublishSingleSchedule(e.facultyId,a).subscribe({next:i=>{this.isToggleAllChecked=this.dataSource.data.length>0&&this.dataSource.data.every(l=>l.isEnabled),this.snackBar.open(`Schedules successfully published for ${e.facultyName}.`,"Close",{duration:3e3})},error:i=>{console.error(`Error toggling schedule for faculty ${e.facultyId}:`,i),e.isEnabled=!e.isEnabled,this.snackBar.open(`Error publishing schedules for ${e.facultyName}.`,"Close",{duration:3e3})}})}updateDisplayedData(){console.log("Paginator updated")}static \u0275fac=function(a){return new(a||t)(S(O),S(H),S(pe))};static \u0275cmp=b({type:t,selectors:[["app-report-faculty"]],viewQuery:function(a,i){if(a&1&&F(w,5),a&2){let l;R(l=D())&&(i.paginator=l.first)}},standalone:!0,features:[V],decls:3,vars:1,consts:[[1,"report-container"],[1,"loading-wrapper"],[1,"report-header-container"],[3,"export","inputChange","inputFields","showExportButton","showAddButton"],[1,"report-table-container"],[1,"table-container"],["mat-table","",1,"custom-table",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","class","custom-header index",4,"matHeaderCellDef"],["mat-cell","","class","index",4,"matCellDef"],["matColumnDef","facultyName"],["mat-header-cell","","class","custom-header",4,"matHeaderCellDef"],["mat-cell","","class","custom-cell",4,"matCellDef"],["matColumnDef","facultyCode"],["matColumnDef","facultyType"],["matColumnDef","facultyUnits"],["matColumnDef","action"],["matColumnDef","toggle"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],["aria-label","Select page",1,"custom-paginator",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell","",1,"custom-header","index"],["mat-cell","",1,"index"],["mat-header-cell","",1,"custom-header"],["mat-cell","",1,"custom-cell"],[1,"faculty-type",3,"ngClass"],["mat-button","",1,"sec-ripple","view-button",3,"click"],["mat-button","",1,"sec-ripple","export-button",3,"click"],[1,"header-toggle",3,"change","matTooltip","checked","disabled"],[3,"ngModelChange","change","ngModel","disabled","matTooltip"],["mat-header-row",""],["mat-row",""],[1,"no-data-cell"],[1,"flex-cell"],[1,"no-data-text"],["mat-symbol","info"]],template:function(a,i){a&1&&(n(0,"div",0),m(1,ye,2,0,"div",1)(2,Ne,30,13),r()),a&2&&(c(),E(i.isLoading?1:2))},dependencies:[B,L,he,W,re,J,X,ie,Z,K,ae,ee,te,ne,oe,le,_e,w,de,ce,ue,me,Q,z,$,N,G,Y,q,U,P],data:{animation:[j]}})}return t})();export{dt as ReportFacultyComponent};
