import{a as N}from"./chunk-HDBGLD52.js";import"./chunk-R7WH3GYF.js";import{a as M}from"./chunk-PAWPQVJP.js";import{e as I,f as A}from"./chunk-2PMUV4MH.js";import"./chunk-OJYR24EB.js";import"./chunk-A3A72ILT.js";import{a as E}from"./chunk-TVMSW2JO.js";import"./chunk-CUKNIT7M.js";import{a as P}from"./chunk-AY56TXUB.js";import{v as F}from"./chunk-VMH4ILIM.js";import"./chunk-6AWQUBPH.js";import"./chunk-HZKDOO2A.js";import"./chunk-JLIX64RS.js";import{c as B}from"./chunk-VORQTW3B.js";import"./chunk-FVBRAVME.js";import"./chunk-L2D7AHNW.js";import"./chunk-POHCU53O.js";import{a as V}from"./chunk-6QI4QBU5.js";import"./chunk-DXFFT4B6.js";import"./chunk-UJ255QIO.js";import"./chunk-MXV4M2BO.js";import"./chunk-4N6BO7AP.js";import"./chunk-RU375CWH.js";import"./chunk-KXJUWRJT.js";import"./chunk-SB5MWYDA.js";import"./chunk-EMZRNCIP.js";import"./chunk-DKHW3YWA.js";import{t as L}from"./chunk-2T5SWUVG.js";import{Cb as C,Db as b,Eb as v,Ib as k,Nb as _,Pb as o,Wa as g,Xa as m,gc as S,ha as x,mb as y,qa as d,ra as l,rb as u,xb as w,zc as D}from"./chunk-NSU275EB.js";import{a as c,b as p,c as h}from"./chunk-ODN5LVDJ.js";function q(a,R){a&1&&v(0,"app-loading")}function j(a,R){if(a&1){let e=k();C(0,"div",0)(1,"div",1)(2,"app-table-header",2),_("search",function(t){d(e);let n=o();return l(n.onSearch(t))})("add",function(){d(e);let t=o();return l(t.openAddAdminDialog())}),b()(),C(3,"div",3)(4,"app-table-generic",4),_("edit",function(t){d(e);let n=o();return l(n.openEditAdminDialog(t))})("delete",function(t){d(e);let n=o();return l(n.deleteAdmin(t))}),b()()()}if(a&2){let e=o();u("@fadeAnimation",void 0),g(2),u("searchLabel","Search Admins")("addButtonLabel","Add Admin")("inputFields",e.headerInputFields),g(2),u("columns",e.columns)("data",e.admins)("displayedColumns",e.displayedColumns)("showViewButton",!1)}}var Z=(()=>{class a{cdr;dialog;snackBar;adminService;adminStatuses=["Active","Inactive"];selectedAdminIndex=null;admins=[];isLoading=!0;columns=[{key:"index",label:"#"},{key:"code",label:"Admin Code"},{key:"name",label:"Name"},{key:"passwordDisplay",label:"Password"},{key:"role",label:"Role"},{key:"status",label:"Status"}];displayedColumns=["index","code","name","passwordDisplay","role","status","action"];headerInputFields=[{type:"text",label:"Search Admin",key:"search"}];constructor(e,i,t,n){this.cdr=e,this.dialog=i,this.snackBar=t,this.adminService=n}ngOnInit(){this.fetchAdmins()}fetchAdmins(){this.isLoading=!0,this.adminService.getAdmins().subscribe({next:e=>{this.admins=e.map(i=>p(c({},i),{passwordDisplay:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})),this.isLoading=!1,this.cdr.markForCheck()},error:()=>{this.snackBar.open("Error fetching admins. Please try again.","Close",{duration:3e3}),this.isLoading=!1}})}onSearch(e){this.adminService.getAdmins().subscribe(i=>{this.admins=i.filter(t=>t.id.includes(e)||t.name.toLowerCase().includes(e.toLowerCase())||t.role.toLowerCase().includes(e.toLowerCase())),this.cdr.markForCheck()})}getDialogConfig(e){return{title:"Admin",isEdit:!!e,fields:[{label:"Admin Code",formControlName:"code",type:"text",maxLength:20,required:!0,disabled:!e},{label:"Name",formControlName:"name",type:"text",maxLength:50,required:!0},{label:"Password",formControlName:"password",type:"text",maxLength:100,required:!e},{label:"Confirm Password",formControlName:"confirmPassword",type:"text",maxLength:100,required:!e,confirmPassword:!0},{label:"Role",formControlName:"role",type:"select",options:["admin","superadmin"],required:!0},{label:"Status",formControlName:"status",type:"select",options:this.adminStatuses,required:!0}],initialValue:e?p(c({},e),{password:""}):{status:"Active"}}}openAddAdminDialog(){let e=this.getDialogConfig();this.dialog.open(A,{data:e,disableClose:!0}).afterClosed().subscribe(t=>{if(t){let n=t,{confirmPassword:f}=n,r=h(n,["confirmPassword"]);this.adminService.addAdmin(r).subscribe({next:s=>{this.snackBar.open("Admin added successfully","Close",{duration:3e3}),this.fetchAdmins()},error:s=>{this.snackBar.open("Error adding admin. Please try again.","Close",{duration:3e3}),console.error("Error adding admin:",s)}})}})}openEditAdminDialog(e){let i=this.getDialogConfig(e);this.dialog.open(A,{data:i,disableClose:!0}).afterClosed().subscribe(n=>{n&&this.updateAdmin(e.id,n)})}updateAdmin(e,i){let f=i,{confirmPassword:t}=f,n=h(f,["confirmPassword"]);n.password||delete n.password,this.adminService.updateAdmin(e,n).subscribe({next:r=>{let s=this.admins.findIndex(T=>T.id===e);s!==-1&&(this.admins[s]=p(c({},r),{passwordDisplay:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})),this.snackBar.open("Admin updated successfully","Close",{duration:3e3}),this.fetchAdmins(),this.cdr.markForCheck()},error:r=>{this.snackBar.open("Error updating admin. Please try again.","Close",{duration:3e3}),console.error("Error updating admin:",r)}})}deleteAdmin(e){let i=this.admins.indexOf(e);i>=0&&this.adminService.deleteAdmin(e.id).subscribe(()=>{this.admins.splice(i,1),this.snackBar.open("Admin deleted successfully","Close",{duration:3e3}),this.fetchAdmins(),this.cdr.markForCheck()})}static \u0275fac=function(i){return new(i||a)(m(D),m(B),m(E),m(I))};static \u0275cmp=x({type:a,selectors:[["app-admin"]],standalone:!0,features:[S],decls:2,vars:1,consts:[[1,"admin-management-container"],[1,"admin-header-container"],[3,"search","add","searchLabel","addButtonLabel","inputFields"],[1,"admin-table-container"],[3,"edit","delete","columns","data","displayedColumns","showViewButton"]],template:function(i,t){i&1&&y(0,q,1,0,"app-loading")(1,j,5,8,"div",0),i&2&&w(t.isLoading?0:1)},dependencies:[L,F,N,M,P],styles:[".admin-management-container[_ngcontent-%COMP%]{transition:background-color .3s ease;display:flex;flex-direction:column;gap:var(--spacing-xs);height:100%}.admin-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:none;justify-content:none;gap:0;-ms-overflow-style:none;scrollbar-width:none;flex:1;overflow:auto;position:relative;border-radius:var(--border-radius-md)}.admin-table-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"],data:{animation:[V]},changeDetection:0})}return a})();export{Z as AdminComponent};
