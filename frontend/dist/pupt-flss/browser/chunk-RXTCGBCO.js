import{a as N}from"./chunk-HDBGLD52.js";import"./chunk-R7WH3GYF.js";import{a as $}from"./chunk-HE5QXQ2G.js";import{e as C}from"./chunk-UFL4XQUW.js";import"./chunk-OJYR24EB.js";import"./chunk-A3A72ILT.js";import{a as T}from"./chunk-TVMSW2JO.js";import"./chunk-CUKNIT7M.js";import{a as j}from"./chunk-AY56TXUB.js";import{v as M}from"./chunk-VMH4ILIM.js";import"./chunk-6AWQUBPH.js";import"./chunk-HZKDOO2A.js";import"./chunk-JLIX64RS.js";import{c as V}from"./chunk-VORQTW3B.js";import"./chunk-FVBRAVME.js";import"./chunk-L2D7AHNW.js";import"./chunk-POHCU53O.js";import{a as H}from"./chunk-6QI4QBU5.js";import"./chunk-DXFFT4B6.js";import"./chunk-UJ255QIO.js";import"./chunk-MXV4M2BO.js";import"./chunk-4N6BO7AP.js";import"./chunk-RU375CWH.js";import"./chunk-KXJUWRJT.js";import{a as B}from"./chunk-SB5MWYDA.js";import{a as F}from"./chunk-EMZRNCIP.js";import{a as L,c as I}from"./chunk-DKHW3YWA.js";import{t as D}from"./chunk-2T5SWUVG.js";import{Cb as u,Db as f,Eb as v,Ib as w,Nb as g,Pb as o,Wa as h,Xa as d,Z as A,ca as p,gc as k,ha as _,mb as y,qa as s,ra as r,rb as c,xb as x,zc as S}from"./chunk-NSU275EB.js";import{a as l,b as m}from"./chunk-ODN5LVDJ.js";var R=(()=>{class n{http;cookieService;baseUrl=F.apiUrl;constructor(e,t){this.http=e,this.cookieService=t}getHeaders(){let e=this.cookieService.get("token");return new L({Authorization:`Bearer ${e}`,"Content-Type":"application/json",Accept:"application/json"})}getAdmins(){return this.http.get(`${this.baseUrl}/getAdmins`,{headers:this.getHeaders()})}getAdminById(e){return this.http.get(`${this.baseUrl}/getAdmins/${e}`,{headers:this.getHeaders()})}addAdmin(e){return this.http.post(`${this.baseUrl}/addAdmins`,e,{headers:this.getHeaders()})}updateAdmin(e,t){return this.http.put(`${this.baseUrl}/updateAdmins/${e}`,t,{headers:this.getHeaders()})}deleteAdmin(e){return this.http.delete(`${this.baseUrl}/deleteAdmins/${e}`,{headers:this.getHeaders()})}static \u0275fac=function(t){return new(t||n)(p(I),p(B))};static \u0275prov=A({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function O(n,U){n&1&&v(0,"app-loading")}function z(n,U){if(n&1){let e=w();u(0,"div",0)(1,"div",1)(2,"app-table-header",2),g("search",function(i){s(e);let a=o();return r(a.onSearch(i))})("add",function(){s(e);let i=o();return r(i.openAddAdminDialog())}),f()(),u(3,"div",3)(4,"app-table-generic",4),g("edit",function(i){s(e);let a=o();return r(a.openEditAdminDialog(i))})("delete",function(i){s(e);let a=o();return r(a.deleteAdmin(i))}),f()()()}if(n&2){let e=o();c("@fadeAnimation",void 0),h(2),c("searchLabel","Search Admins")("addButtonLabel","Add Admin")("inputFields",e.headerInputFields),h(2),c("columns",e.columns)("data",e.admins)("displayedColumns",e.displayedColumns)("showViewButton",!1)}}var oe=(()=>{class n{cdr;dialog;snackBar;adminService;adminStatuses=["Active","Inactive"];selectedAdminIndex=null;admins=[];isLoading=!0;columns=[{key:"index",label:"#"},{key:"code",label:"Admin Code"},{key:"name",label:"Name"},{key:"passwordDisplay",label:"Password"},{key:"role",label:"Role"},{key:"status",label:"Status"}];displayedColumns=["index","code","name","passwordDisplay","role","status","action"];headerInputFields=[{type:"text",label:"Search Admin",key:"search"}];constructor(e,t,i,a){this.cdr=e,this.dialog=t,this.snackBar=i,this.adminService=a}ngOnInit(){this.fetchAdmins()}fetchAdmins(){this.isLoading=!0,this.adminService.getAdmins().subscribe({next:e=>{this.admins=e.map(t=>m(l({},t),{passwordDisplay:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})),this.isLoading=!1,this.cdr.markForCheck()},error:()=>{this.snackBar.open("Error fetching admins. Please try again.","Close",{duration:3e3}),this.isLoading=!1}})}onSearch(e){this.adminService.getAdmins().subscribe(t=>{this.admins=t.filter(i=>i.id.includes(e)||i.name.toLowerCase().includes(e.toLowerCase())||i.role.toLowerCase().includes(e.toLowerCase())),this.cdr.markForCheck()})}getDialogConfig(e){return{title:"Admin",isEdit:!!e,fields:[{label:"Admin Code",formControlName:"code",type:"text",maxLength:20,required:!0},{label:"Name",formControlName:"name",type:"text",maxLength:50,required:!0},{label:"Password",formControlName:"password",type:"text",maxLength:100,required:!1},{label:"Role",formControlName:"role",type:"select",options:["admin","superadmin"],required:!0},{label:"Status",formControlName:"status",type:"select",options:this.adminStatuses,required:!0}],initialValue:e?m(l({},e),{password:""}):{}}}openAddAdminDialog(){let e=this.getDialogConfig();this.dialog.open(C,{data:e,disableClose:!0}).afterClosed().subscribe(i=>{i&&this.adminService.addAdmin(i).subscribe(a=>{this.admins.push(a),this.snackBar.open("Admin added successfully","Close",{duration:3e3}),this.fetchAdmins(),this.cdr.markForCheck()})})}openEditAdminDialog(e){let t=this.getDialogConfig(e);this.dialog.open(C,{data:t,disableClose:!0}).afterClosed().subscribe(a=>{a&&this.updateAdmin(e.id,a)})}updateAdmin(e,t){let i={name:t.name,role:t.role,status:t.status};t.password&&(i.password=t.password),this.adminService.updateAdmin(e,i).subscribe(a=>{let b=this.admins.findIndex(E=>E.id===e);b!==-1&&(this.admins[b]=m(l({},a),{passwordDisplay:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",email:a.faculty?.faculty_email||""})),this.snackBar.open("Admin updated successfully","Close",{duration:3e3}),this.fetchAdmins(),this.cdr.markForCheck()})}deleteAdmin(e){let t=this.admins.indexOf(e);t>=0&&this.adminService.deleteAdmin(e.id).subscribe(()=>{this.admins.splice(t,1),this.snackBar.open("Admin deleted successfully","Close",{duration:3e3}),this.fetchAdmins(),this.cdr.markForCheck()})}static \u0275fac=function(t){return new(t||n)(d(S),d(V),d(T),d(R))};static \u0275cmp=_({type:n,selectors:[["app-admin"]],standalone:!0,features:[k],decls:2,vars:1,consts:[[1,"admin-management-container"],[1,"admin-header-container"],[3,"search","add","searchLabel","addButtonLabel","inputFields"],[1,"admin-table-container"],[3,"edit","delete","columns","data","displayedColumns","showViewButton"]],template:function(t,i){t&1&&y(0,O,1,0,"app-loading")(1,z,5,8,"div",0),t&2&&x(i.isLoading?0:1)},dependencies:[D,M,N,$,j],styles:[".admin-management-container[_ngcontent-%COMP%]{transition:background-color .3s ease;display:flex;flex-direction:column;gap:var(--spacing-xs);height:100%}.admin-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:none;justify-content:none;gap:0;-ms-overflow-style:none;scrollbar-width:none;flex:1;overflow:auto;position:relative;border-radius:var(--border-radius-md)}.admin-table-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"],data:{animation:[H]},changeDetection:0})}return n})();export{oe as AdminComponent};
